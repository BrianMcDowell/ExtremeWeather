<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="MainPageClass.css">

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <!-- Bootstrap JS (and dependencies) -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    </head>
    <body class="mainBody">


        <nav class="navbar sticky-top navbar-light" style="background-color: #fa8b37;">
          <div class="container-fluid">
              <a class="navbar-brand titleText" href="#"><b>CIS4301 DEMO: ExtremeWeather Project UNNAMED</b></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Features</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Pricing</a>
                </li>
              </ul>
              <span class="navbar-text">
                Navbar text with an inline element
              </span>
            </div>
          </div>
        </nav>

        <form action="" id="weatherForm" style="text-align: center;" method="post">
            {% csrf_token %}
        <p class="categoryOption">
            <u>Choose FIPS:</u>
            <select class="form-select" name="selectfips" aria-label="FIPS Select">
                <option value="--" selected>--</option>
                {% for iter in location_data %}
                    <option value={{ iter.0 }}>{{ iter.2 }} - {{ iter.0 }} - {{ iter.1 }}</option>
                {% endfor %}

            </select>
        </p>

        <!-- CHOOSE WEATHER INTEREST -->
        <p class="categoryOption"><u>Choose your Weather Interest:</u></p>
        <div class="checkbox-group" id="WeatherCheckbox">
          <input type="checkbox" id="option1" name="Tornado" value="TORN">
          <label for="option1">Tornado</label>
          <input type="checkbox" id="option2" name="Hail" value="HAIL">
          <label for="option2">Hail</label>
          <input type="checkbox" id="option3" name="Wind" value="WIND">
          <label for="option3">Wind</label>
        </div>

        <p><br></p>
        <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
            <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" value="pop" checked>
            <label class="btn btn-outline-primary" for="btnradio1">Population vs Weather</label>

            <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off" value="hpi">
            <label class="btn btn-outline-primary" for="btnradio2">Housing Prices Vs Weather</label>

            <input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off" value="xw">
            <label class="btn btn-outline-primary" for="btnradio3">Weather Vs Weather</label>
        </div>

        <!-- SUBMIT AND CLEAR BUTTONS -->
        <p><br></p>
        <input type="submit" value="Submit" class="btn btn-secondary">
        <input type="hidden" name="onefips">
        <input type="button" value="Clear" onclick="resetForm()" class="clearBtn">
        </form>

        {% if the_chart.ioi != "xw"  and the_chart.fips_ct == 1%}
            <div>
                <p>Item of Interest: {{ the_chart.ioi|safe }}</p>
                <p>Weather events: {{ the_chart.events|safe }}</p>
            <p>{{ the_chart|length }}</p>
            </div>
            <div>
                <canvas id="myChart" width="400" height="400"></canvas>
            </div>
            <script>
                let yr={{ the_chart.yr|safe }};
                let d1={{ the_chart.d1|safe }};
                let d2={{ the_chart.d2|safe }};
                let ctx = document.getElementById('myChart');

                let myChart = new Chart(ctx, {
                    data: {
                        labels: yr,
                        datasets: [
                            {type: 'line', label: 'Item of Interest', data: d1, yAxisID: 'y1',},
                            {type: 'bar', label: 'Weather Events', data: d2, yAxisID: 'y2',},
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                            },
                            y2: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {drawOnChartArea: false,}
                            }
                        }
                    }
                });
            </script>
        {% elif the_chart.fips_ct == 1 %}
            <div>
                <p>{{ the_chart.ioi|safe }}</p>
                <canvas id="xwChart" width="400" height="400"></canvas>
            </div>
            <script>
                let yr={{ the_chart.yr|safe }};
                let d1={{ the_chart.d1|safe }};
                let d2={{ the_chart.d2|safe }};
                let d3={{ the_chart.d3|safe }};
                let ctx = document.getElementById('xwChart');

                let xwChart = new Chart(ctx, {
                    data: {
                        labels: yr,
                        datasets: [
                            {type: 'bar', label: 'Tornado', data: d1,},
                            {type: 'bar', label: 'Hail', data: d2,},
                            {type: 'bar', label: 'Wind', data: d3,},
                        ]
                    },
                    options: {
                        responsive: true,
                    }
                });
            </script>
        {% endif %}


        <!-- Comparing two counties -->
        <form action="" id="weatherForm" style="text-align: center;" method="post">
            {% csrf_token %}
        <p class="categoryOption">
            <u>Choose FIPS:</u>
            <select class="form-select" name="selectfips1" aria-label="FIPS Select">
                <option value="--" selected>--</option>
                {% for iter in location_data %}
                    <option value={{ iter.0 }}>{{ iter.2 }} - {{ iter.0 }} - {{ iter.1 }}</option>
                {% endfor %}
            </select>
        </p>

        <p class="categoryOption">
            <u>Choose FIPS:</u>
            <select class="form-select" name="selectfips2" aria-label="FIPS Select">
                <option value="--" selected>--</option>
                {% for iter in location_data %}
                    <option value={{ iter.0 }}>{{ iter.2 }} - {{ iter.0 }} - {{ iter.1 }}</option>
                {% endfor %}
            </select>
        </p>


        <p><br></p>


        <!-- SUBMIT AND CLEAR BUTTONS -->
        <p><br></p>
        <input type="submit" value="Submit" class="btn btn-secondary">
        <input type="hidden" name="twofips">
        <input type="button" value="Clear" onclick="resetForm()" class="clearBtn">
        </form>

        {% if the_chart.fips_ct == 2 %}
            <div>
                <p>Item of Interest: {{ the_chart.ioi|safe }}</p>
                <p>Weather events: {{ the_chart.events|safe }}</p>
            <p>{{ the_chart|length }}</p>
            </div>
            <div>
                <canvas id="fipsChart" width="500" height="500"></canvas>
            </div>
            <script>
                let yr={{ the_chart.yr|safe }};
                let d1={{ the_chart.d1|safe }};
                let d2={{ the_chart.d2|safe }};
                let ctx2 = document.getElementById('fipsChart');

                let fipsChart = new Chart(ctx2, {
                    data: {
                        labels: yr,
                        datasets: [
                            {type: 'line', label: 'avg event 1', data: d1,},
                            {type: 'line', label: 'avg event 2', data: d2,},
                        ]
                    },
                    options: {
                        responsive: false,
                    }
                });
            </script>
        {%  endif %}


    <!-- Entire Form Reset function -->
    <script>
        function resetForm() {
            document.getElementById("weatherForm").reset();
            document.getElementById("WeatherCheckbox").checked = false;
            document.getElementById("YearDropdown").selectedIndex = 0;
            document.getElementById("RentDropdown").selectedIndex = 0;
            document.getElementById("RoomsCheckbox").checked = false;
        }
    </script>
    </body>
</html>

